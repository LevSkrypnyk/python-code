import pandas as pd
import matplotlib.pyplot as plt

# –ö—Ä–æ–∫ 1: –ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –¥–∞–Ω–∏—Ö –∑ —É—Ä–∞—Ö—É–≤–∞–Ω–Ω—è–º –º–æ–∂–ª–∏–≤–∏—Ö –Ω–µ—Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∏—Ö —Ä–æ–∑–¥—ñ–ª—å–Ω–∏–∫—ñ–≤
df = pd.read_csv('data.csv', encoding='latin1', engine='python')

# –ö—Ä–æ–∫ 2: –ü–µ—Ä–µ–π–º–µ–Ω–æ–≤—É—î–º–æ –ø–µ—Ä—à–∏–π —Å—Ç–æ–≤–ø–µ—Ü—å –Ω–∞ "Date"
df.rename(columns={df.columns[0]: 'Date'}, inplace=True)

# –ö—Ä–æ–∫ 3: –í–∏–¥—ñ–ª—è—î–º–æ —Ç—ñ–ª—å–∫–∏ –¥–∞—Ç—É –∑ "–¥–∞—Ç–∞,—á–∞—Å", –Ω–∞–ø—Ä–∏–∫–ª–∞–¥: "01/01/2011,00:00"
df['Date'] = pd.to_datetime(df['Date'].str.split(',').str[0], dayfirst=True)

# –ö—Ä–æ–∫ 4: –†–æ–±–∏–º–æ –∫–æ–ª–æ–Ω–∫—É 'Date' —ñ–Ω–¥–µ–∫—Å–æ–º
df.set_index('Date', inplace=True)

# –î—ñ–∞–≥–Ω–æ—Å—Ç–∏–∫–∞: –ø–æ–∫–∞–∑–∞—Ç–∏ –ø–µ—Ä—à—ñ —Ä—è–¥–∫–∏ —Ç–∞ —Å–ø–∏—Å–æ–∫ –∫–æ–ª–æ–Ω–æ–∫
print("–ü–µ—Ä—à—ñ —Ä—è–¥–∫–∏ –¥–∞—Ç–∞—Ñ—Ä–µ–π–º—É:")
print(df.head(3))
print("\n–°—Ç–æ–≤–ø—Ü—ñ:", df.columns)

# –ö—Ä–æ–∫ 5: –ü–æ–±—É–¥–æ–≤–∞ –≥—Ä–∞—Ñ—ñ–∫—É
plt.figure(figsize=(15, 10))
df.plot(ax=plt.gca(), title='–í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è –≤–µ–ª–æ–¥–æ—Ä—ñ–∂–æ–∫ —É 2011 —Ä–æ—Ü—ñ')
plt.xlabel('–î–∞—Ç–∞')
plt.ylabel('–ö—ñ–ª—å–∫—ñ—Å—Ç—å –≤–µ–ª–æ—Å–∏–ø–µ–¥–∏—Å—Ç—ñ–≤')
plt.grid(True)
plt.tight_layout()
plt.show()

# –ö—Ä–æ–∫ 6: –û–±—á–∏—Å–ª–µ–Ω–Ω—è —Å—É–º–∞—Ä–Ω–æ–≥–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è —Ç–∞ –Ω–∞–π–ø–æ–ø—É–ª—è—Ä–Ω—ñ—à–æ–≥–æ –º—ñ—Å—è—Ü—è
df['Total'] = df.sum(axis=1)
monthly_totals = df.resample('M').sum()
most_popular_month = monthly_totals['Total'].idxmax().strftime('%B')

print(f"\nüìÖ –ù–∞–π–ø–æ–ø—É–ª—è—Ä–Ω—ñ—à–∏–π –º—ñ—Å—è—Ü—å —Å–µ—Ä–µ–¥ –≤–µ–ª–æ—Å–∏–ø–µ–¥–∏—Å—Ç—ñ–≤ —É 2011 —Ä–æ—Ü—ñ: {most_popular_month}")
